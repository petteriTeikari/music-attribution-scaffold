# CI/CD Pipeline
#
# Continuous integration and deployment tooling.

decision_id: ci_cd_pipeline
title: "CI/CD Pipeline"
description: >
  Determines the continuous integration and deployment tooling. Affects
  development velocity, code quality enforcement, and deployment safety.
  The choice ranges from platform-native auto-deploy (zero config) to
  full CI/CD pipelines with custom stages.

decision_level: L4_deployment
status: active
last_updated: 2026-02-10

options:
  - option_id: github_actions
    title: "GitHub Actions"
    description: >
      CI/CD integrated with GitHub. Workflow files in .github/workflows/.
      Broad action marketplace, good caching, matrix builds. Free tier
      for public repos, generous for private.
    prior_probability: 0.45
    status: recommended

  - option_id: platform_native_autodeploy
    title: "Platform Native Auto-Deploy"
    description: >
      Git-push auto-deploy via Render/Railway/Vercel. Zero CI config.
      Pre-commit hooks run locally, deployment happens on push.
      Simple but no pipeline customization.
    prior_probability: 0.30
    status: viable

  - option_id: gitlab_ci
    title: "GitLab CI"
    description: >
      GitLab's built-in CI/CD. Strong pipeline visualization,
      built-in registry, good for self-hosted setups.
    prior_probability: 0.10
    status: viable
    constraints:
      - "GitLab as source control"

  - option_id: custom_pipeline
    title: "Custom Pipeline (Dagger/Earthly)"
    description: >
      Programmable CI with container-based build definitions.
      Reproducible builds, local testing of CI steps. Higher
      setup cost, better long-term maintainability.
    prior_probability: 0.15
    status: experimental

conditional_on:
  - parent_decision_id: build_vs_buy_posture
    influence_strength: moderate
    conditional_table:
      - given_parent_option: custom_build
        then_probabilities:
          github_actions: 0.40
          platform_native_autodeploy: 0.15
          gitlab_ci: 0.15
          custom_pipeline: 0.30
      - given_parent_option: managed_services
        then_probabilities:
          github_actions: 0.45
          platform_native_autodeploy: 0.35
          gitlab_ci: 0.10
          custom_pipeline: 0.10
      - given_parent_option: saas_maximalist
        then_probabilities:
          github_actions: 0.35
          platform_native_autodeploy: 0.50
          gitlab_ci: 0.05
          custom_pipeline: 0.10

archetype_weights:
  engineer_heavy_startup:
    probability_overrides:
      github_actions: 0.40
      platform_native_autodeploy: 0.10
      gitlab_ci: 0.15
      custom_pipeline: 0.35
    rationale: "Engineers value reproducible builds and custom pipelines."

  musician_first_team:
    probability_overrides:
      github_actions: 0.35
      platform_native_autodeploy: 0.50
      gitlab_ci: 0.05
      custom_pipeline: 0.10
    rationale: "Auto-deploy minimizes CI complexity."

  solo_hacker:
    probability_overrides:
      github_actions: 0.40
      platform_native_autodeploy: 0.45
      gitlab_ci: 0.05
      custom_pipeline: 0.10
    rationale: "Auto-deploy for speed. GitHub Actions when tests needed."

  well_funded_startup:
    probability_overrides:
      github_actions: 0.45
      platform_native_autodeploy: 0.15
      gitlab_ci: 0.15
      custom_pipeline: 0.25
    rationale: "GitHub Actions as standard, custom pipeline for complex builds."

volatility:
  classification: stable
  last_assessed: 2026-02-10
  next_review: 2026-05-10
  change_drivers:
    - "GitHub Actions pricing changes"
    - "Dagger/Earthly ecosystem maturity"

domain_applicability:
  music_attribution: 1.0
  dpp_traceability: 1.0
  generic_graph_rag: 1.0

tags:
  - deployment
  - ci-cd
  - automation

references:
  - "../infrastructure/toc-infrastructure.md"
